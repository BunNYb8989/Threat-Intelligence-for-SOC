# Threat-Intelligence-for-SOC
<p align="center">
<br/>
  <img src="intro.png"/>
<br/>
<br/>
</p>
In this room, we will highlight the impact of Threat Intelligence in the Security Operations pipeline; how important information shared across different groups can be utilised by your organisation. In addition, we will tackle topics such as the following throughout the room

Types of Threat Intelligence

Utilising Threat Intelligence to Prevent and Detect malicious activities

Threat Intelligence Consumers and Producers
# Task 2


<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/start t2.png"/>
<br/>
<br/>
</p>


## 1.How many unique IP addresses were provided in the IOC list?
Answer:
<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/q1.png"/>
<br/>
<br/>
</p>

## 2.Based on the set of IOCs, how many IOC hits were discovered in the logs?
<p align="center">
<br/>
  <img src="<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/q2.png"/>
<br/>
</p>

## 3.Out of the total number of IOCs, how many unique IP addresses were discovered in the logs?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/q3.png"/>
<br/>
<br/>
</p>

## 4.How many connections were made to 185[.]224[.]128[.]215?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/q4.png"/>
<br/>
<br/>
</p>

## 5.What is the IP address of the compromised host? 

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/q5.png"/>
<br/>
<br/>
</p>

## 6.What is the destination port of connections made to 107[.]175[.]202[.]151?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/q6.png"/>
<br/>
<br/>
</p>

# Task 3 

Hunting Sinkholed Domains

Using the logs generated by the SIEM, you are tasked to hunt all domains identified as malicious by your DNS Sinkhole. The Threat Intelligence team has provided a single domain to start with your activity:

agrosaoxe[.]info
In addition, you may also need the following KQL query templates to complete the investigation:

dns.question.name: "replace with domain"
dns.answers.data: "replace with sinkhole IP"
Note that you need to remove the defang in your search query.

Lastly, the events are stored in the filebeat-* index. Ensure the search query is between 02/14/2023 and 02/17/2023. Good luck! 


<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/task3.png"/>
<br/>
<br/>
</p>

## 1.How many DNS queries to agrosaoxe[.]info have been created?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t3_q1.png"/>
<br/>
<br/>
</p>

## 2.Before deploying the sinkhole configuration, what IPv4 addresses are resolved by agrosaoxe[.]info? (format: IPs in ascending order)

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t3_q2.png"/>
<br/>
<br/>
</p>

## 3.What is the IP address used for DNS Sinkhole?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t3_q3.png"/>
<br/>
<br/>
</p>

## 4.How many hits were caused by connections to sinkholed domains?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t3_q4.png"/>
<br/>
<br/>
</p>

## 5.How many unique domains have been sinkholed?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t3_q5.png"/>
<br/>
<br/>
</p>

# Task 4

The elastalert command above can be broken down as:

ElastAlert executes the rule we configured starting from 02/16/2023 until the present.
It also provides verbose output. 
Lastly, the snippet uses 2>&1 | tee output.txt to write the results into output.txt. Note that file descriptors were used since the output is being written at the INFO level.
Once the command is executed, you may need to wait a few seconds to finish the initial run. The following string indicates that the execution is finished: X query hits (X already seen), X matches, X alerts sent

After seeing the string above, you can now stop the execution of the elastalert command with CTRL + C.

To complete the task, review the results written in ~/elastalert/output.txt to answer the questions below.

## 1.What is the value of the alert field in the converted ElastAlert rule?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t4_q1.png"/>
<br/>
<br/>
</p>

## 2.How many alerts were generated by the rule?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t4_q2 (2).png"/>
<br/>
<br/>
</p>

## 3.How many unique domains were sinkholed via 0.0.0.0?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t4_q3.png"/>
<br/>
<br/>
</p>

## 4.What is the sinkholed domain that has .ru TLD?

<p align="center">
<br/>
  <img src="Threat Intelligence for SOC/t4_q4.png"/>
<br/>
<br/>
</p>
